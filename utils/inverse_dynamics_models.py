import numpy as np

# Derived from EXPLICIT
# [REF] https://github.com/explicit-robotics/Explicit-MATLAB
# For people who are interested about the details of deriving these values, please feel free to reach out to me:
# [Email] mosesnah@mit.edu

def get2DOF_M( q_arr ):
    q1, q2 = q_arr

    M = np.zeros( ( 2, 2 ) )
    M[0, 0] = np.cos(q2) + 7/2
    M[0, 1] = np.cos(q2)/2 + 5/4
    M[1, 0] = np.cos(q2)/2 + 5/4
    M[1, 1] = 5/4

    return M

def get2DOF_C( q_arr, dq_arr ):
    q1,   q2 = q_arr
    dq1, dq2 = dq_arr

    C = np.zeros( ( 2, 2 ) )
    C[0, 0] = -(dq2*np.sin(q2))/2
    C[0, 1] = -(np.sin(q2)*(dq1 + dq2))/2
    C[1, 0] = (dq1*np.sin(q2))/2
    C[1, 1] = 0    

    return C

def get2DOF_J( q_arr ):
    q1, q2 = q_arr
    J = np.zeros( ( 2, 2 ) )
    J[0, 0] = - np.sin(q1 + q2) - np.sin(q1)
    J[0, 1] = -np.sin(q1 + q2)
    J[1, 0] = np.cos(q1 + q2) + np.cos(q1)
    J[1, 1] = np.cos(q1 + q2)

    return J   

def get2DOF_dJ( q_arr, dq_arr ):
    q1,   q2 = q_arr
    dq1, dq2 = dq_arr

    dJ = np.zeros( ( 2, 2 ) )

    dJ[0, 0] = - np.cos(q1 + q2)*(dq1 + dq2) - dq1*np.cos(q1)
    dJ[0, 1] = -np.cos(q1 + q2)*(dq1 + dq2)
    dJ[1, 0] = - np.sin(q1 + q2)*(dq1 + dq2) - dq1*np.sin(q1)
    dJ[1, 1] = -np.sin(q1 + q2)*(dq1 + dq2)

    return dJ

def get2DOF_IK( p_arr ):

    q_arr = np.zeros( 2 )

    px = p_arr[ 0 ]
    py = p_arr[ 1 ]

    # Solve the inverse kinematics 
    q_arr[ 1 ] = np.pi - np.arccos( np.clip( 0.5 * ( 2 - px ** 2 - py ** 2  ), -1, 1 ) )
    q_arr[ 0 ] = np.arctan2( py, px ) - q_arr[ 1 ]/2     

    return q_arr



# Helper Functions generated from MATLAB
# For a 5DOF Robot
def get5DOF_C( qpos, qvel  ):
    q1 = qpos[ 0 ]
    q2 = qpos[ 1 ]
    q3 = qpos[ 2 ]
    q4 = qpos[ 3 ]
    q5 = qpos[ 4 ]

    dq1 = qvel[ 0 ]
    dq2 = qvel[ 1 ]
    dq3 = qvel[ 2 ]
    dq4 = qvel[ 3 ]
    dq5 = qvel[ 4 ]    

    C = np.zeros( ( 5, 5 ) )

    C[0, 0] = - (dq2*np.sin(q2 + q3 + q4 + q5))/2 - (dq3*np.sin(q2 + q3 + q4 + q5))/2 - (dq4*np.sin(q2 + q3 + q4 + q5))/2 - (dq5*np.sin(q2 + q3 + q4 + q5))/2 - (5*dq2*np.sin(q2 + q3))/2 - (5*dq3*np.sin(q2 + q3))/2 - (3*dq3*np.sin(q3 + q4))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (7*dq2*np.sin(q2))/2 - (5*dq3*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 - (3*dq2*np.sin(q2 + q3 + q4))/2 - (3*dq3*np.sin(q2 + q3 + q4))/2 - (3*dq4*np.sin(q2 + q3 + q4))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[0, 1] = - (dq1*np.sin(q2 + q3 + q4 + q5))/2 - (dq2*np.sin(q2 + q3 + q4 + q5))/2 - (dq3*np.sin(q2 + q3 + q4 + q5))/2 - (dq4*np.sin(q2 + q3 + q4 + q5))/2 - (dq5*np.sin(q2 + q3 + q4 + q5))/2 - (5*dq1*np.sin(q2 + q3))/2 - (5*dq2*np.sin(q2 + q3))/2 - (5*dq3*np.sin(q2 + q3))/2 - (3*dq3*np.sin(q3 + q4))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (7*dq1*np.sin(q2))/2 - (7*dq2*np.sin(q2))/2 - (5*dq3*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 - (3*dq1*np.sin(q2 + q3 + q4))/2 - (3*dq2*np.sin(q2 + q3 + q4))/2 - (3*dq3*np.sin(q2 + q3 + q4))/2 - (3*dq4*np.sin(q2 + q3 + q4))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[0, 2] = - (dq1*np.sin(q2 + q3 + q4 + q5))/2 - (dq2*np.sin(q2 + q3 + q4 + q5))/2 - (dq3*np.sin(q2 + q3 + q4 + q5))/2 - (dq4*np.sin(q2 + q3 + q4 + q5))/2 - (dq5*np.sin(q2 + q3 + q4 + q5))/2 - (5*dq1*np.sin(q2 + q3))/2 - (5*dq2*np.sin(q2 + q3))/2 - (3*dq1*np.sin(q3 + q4))/2 - (5*dq3*np.sin(q2 + q3))/2 - (3*dq2*np.sin(q3 + q4))/2 - (3*dq3*np.sin(q3 + q4))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (5*dq1*np.sin(q3))/2 - (5*dq2*np.sin(q3))/2 - (5*dq3*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 - (3*dq1*np.sin(q2 + q3 + q4))/2 - (3*dq2*np.sin(q2 + q3 + q4))/2 - (3*dq3*np.sin(q2 + q3 + q4))/2 - (dq1*np.sin(q3 + q4 + q5))/2 - (3*dq4*np.sin(q2 + q3 + q4))/2 - (dq2*np.sin(q3 + q4 + q5))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[0, 3] = - (dq1*np.sin(q2 + q3 + q4 + q5))/2 - (dq2*np.sin(q2 + q3 + q4 + q5))/2 - (dq3*np.sin(q2 + q3 + q4 + q5))/2 - (dq4*np.sin(q2 + q3 + q4 + q5))/2 - (dq5*np.sin(q2 + q3 + q4 + q5))/2 - (3*dq1*np.sin(q3 + q4))/2 - (3*dq2*np.sin(q3 + q4))/2 - (dq1*np.sin(q4 + q5))/2 - (3*dq3*np.sin(q3 + q4))/2 - (dq2*np.sin(q4 + q5))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq3*np.sin(q4 + q5))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (3*dq1*np.sin(q4))/2 - (3*dq2*np.sin(q4))/2 - (3*dq3*np.sin(q4))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 - (3*dq1*np.sin(q2 + q3 + q4))/2 - (3*dq2*np.sin(q2 + q3 + q4))/2 - (3*dq3*np.sin(q2 + q3 + q4))/2 - (dq1*np.sin(q3 + q4 + q5))/2 - (3*dq4*np.sin(q2 + q3 + q4))/2 - (dq2*np.sin(q3 + q4 + q5))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[0, 4] = -((np.sin(q3 + q4 + q5) + np.sin(q2 + q3 + q4 + q5) + np.sin(q4 + q5) + np.sin(q5))*(dq1 + dq2 + dq3 + dq4 + dq5))/2
    C[1, 0] = (dq1*np.sin(q2 + q3 + q4 + q5))/2 + (5*dq1*np.sin(q2 + q3))/2 - (3*dq3*np.sin(q3 + q4))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 + (7*dq1*np.sin(q2))/2 - (5*dq3*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 + (3*dq1*np.sin(q2 + q3 + q4))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[1, 1] = - (3*dq3*np.sin(q3 + q4))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (5*dq3*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[1, 2] = - (3*dq1*np.sin(q3 + q4))/2 - (3*dq2*np.sin(q3 + q4))/2 - (3*dq3*np.sin(q3 + q4))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (5*dq1*np.sin(q3))/2 - (5*dq2*np.sin(q3))/2 - (5*dq3*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 - (dq1*np.sin(q3 + q4 + q5))/2 - (dq2*np.sin(q3 + q4 + q5))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[1, 3] = - (3*dq1*np.sin(q3 + q4))/2 - (3*dq2*np.sin(q3 + q4))/2 - (dq1*np.sin(q4 + q5))/2 - (3*dq3*np.sin(q3 + q4))/2 - (dq2*np.sin(q4 + q5))/2 - (3*dq4*np.sin(q3 + q4))/2 - (dq3*np.sin(q4 + q5))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (3*dq1*np.sin(q4))/2 - (3*dq2*np.sin(q4))/2 - (3*dq3*np.sin(q4))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 - (dq1*np.sin(q3 + q4 + q5))/2 - (dq2*np.sin(q3 + q4 + q5))/2 - (dq3*np.sin(q3 + q4 + q5))/2 - (dq4*np.sin(q3 + q4 + q5))/2 - (dq5*np.sin(q3 + q4 + q5))/2
    C[1, 4] = -((np.sin(q3 + q4 + q5) + np.sin(q4 + q5) + np.sin(q5))*(dq1 + dq2 + dq3 + dq4 + dq5))/2
    C[2, 0] = (dq1*np.sin(q2 + q3 + q4 + q5))/2 + (5*dq1*np.sin(q2 + q3))/2 + (3*dq1*np.sin(q3 + q4))/2 + (3*dq2*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 + (5*dq1*np.sin(q3))/2 + (5*dq2*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 + (3*dq1*np.sin(q2 + q3 + q4))/2 + (dq1*np.sin(q3 + q4 + q5))/2 + (dq2*np.sin(q3 + q4 + q5))/2
    C[2, 1] = (3*dq1*np.sin(q3 + q4))/2 + (3*dq2*np.sin(q3 + q4))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 + (5*dq1*np.sin(q3))/2 + (5*dq2*np.sin(q3))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2 + (dq1*np.sin(q3 + q4 + q5))/2 + (dq2*np.sin(q3 + q4 + q5))/2
    C[2, 2] = - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2
    C[2, 3] = - (dq1*np.sin(q4 + q5))/2 - (dq2*np.sin(q4 + q5))/2 - (dq3*np.sin(q4 + q5))/2 - (dq4*np.sin(q4 + q5))/2 - (dq5*np.sin(q4 + q5))/2 - (3*dq1*np.sin(q4))/2 - (3*dq2*np.sin(q4))/2 - (3*dq3*np.sin(q4))/2 - (3*dq4*np.sin(q4))/2 - (dq5*np.sin(q5))/2
    C[2, 4] = -((np.sin(q4 + q5) + np.sin(q5))*(dq1 + dq2 + dq3 + dq4 + dq5))/2
    C[3, 0] = (dq1*np.sin(q2 + q3 + q4 + q5))/2 + (3*dq1*np.sin(q3 + q4))/2 + (3*dq2*np.sin(q3 + q4))/2 + (dq1*np.sin(q4 + q5))/2 + (dq2*np.sin(q4 + q5))/2 + (dq3*np.sin(q4 + q5))/2 + (3*dq1*np.sin(q4))/2 + (3*dq2*np.sin(q4))/2 + (3*dq3*np.sin(q4))/2 - (dq5*np.sin(q5))/2 + (3*dq1*np.sin(q2 + q3 + q4))/2 + (dq1*np.sin(q3 + q4 + q5))/2 + (dq2*np.sin(q3 + q4 + q5))/2
    C[3, 1] = (3*dq1*np.sin(q3 + q4))/2 + (3*dq2*np.sin(q3 + q4))/2 + (dq1*np.sin(q4 + q5))/2 + (dq2*np.sin(q4 + q5))/2 + (dq3*np.sin(q4 + q5))/2 + (3*dq1*np.sin(q4))/2 + (3*dq2*np.sin(q4))/2 + (3*dq3*np.sin(q4))/2 - (dq5*np.sin(q5))/2 + (dq1*np.sin(q3 + q4 + q5))/2 + (dq2*np.sin(q3 + q4 + q5))/2
    C[3, 2] = (dq1*np.sin(q4 + q5))/2 + (dq2*np.sin(q4 + q5))/2 + (dq3*np.sin(q4 + q5))/2 + (3*dq1*np.sin(q4))/2 + (3*dq2*np.sin(q4))/2 + (3*dq3*np.sin(q4))/2 - (dq5*np.sin(q5))/2
    C[3, 3] = -(dq5*np.sin(q5))/2
    C[3, 4] = -(np.sin(q5)*(dq1 + dq2 + dq3 + dq4 + dq5))/2
    C[4, 0] = (dq1*np.sin(q2 + q3 + q4 + q5))/2 + (dq1*np.sin(q4 + q5))/2 + (dq2*np.sin(q4 + q5))/2 + (dq3*np.sin(q4 + q5))/2 + (dq1*np.sin(q5))/2 + (dq2*np.sin(q5))/2 + (dq3*np.sin(q5))/2 + (dq4*np.sin(q5))/2 + (dq1*np.sin(q3 + q4 + q5))/2 + (dq2*np.sin(q3 + q4 + q5))/2
    C[4, 1] = (dq1*np.sin(q4 + q5))/2 + (dq2*np.sin(q4 + q5))/2 + (dq3*np.sin(q4 + q5))/2 + (dq1*np.sin(q5))/2 + (dq2*np.sin(q5))/2 + (dq3*np.sin(q5))/2 + (dq4*np.sin(q5))/2 + (dq1*np.sin(q3 + q4 + q5))/2 + (dq2*np.sin(q3 + q4 + q5))/2
    C[4, 2] = (dq1*np.sin(q4 + q5))/2 + (dq2*np.sin(q4 + q5))/2 + (dq3*np.sin(q4 + q5))/2 + (dq1*np.sin(q5))/2 + (dq2*np.sin(q5))/2 + (dq3*np.sin(q5))/2 + (dq4*np.sin(q5))/2
    C[4, 3] = (np.sin(q5)*(dq1 + dq2 + dq3 + dq4))/2
    C[4, 4] = 0

    return C 

def get5DOF_dJ( qpos, qvel ):
    q1 = qpos[ 0 ]
    q2 = qpos[ 1 ]
    q3 = qpos[ 2 ]
    q4 = qpos[ 3 ]
    q5 = qpos[ 4 ]

    dq1 = qvel[ 0 ]
    dq2 = qvel[ 1 ]
    dq3 = qvel[ 2 ]
    dq4 = qvel[ 3 ]
    dq5 = qvel[ 4 ]

    dJ = np.zeros( ( 3, 5 ) )

    dJ[0, 0] = - np.cos(q1 + q2 + q3)*(dq1 + dq2 + dq3) - np.cos(q1 + q2)*(dq1 + dq2) - dq1*np.cos(q1) - np.cos(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.cos(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[0, 1] = - np.cos(q1 + q2 + q3)*(dq1 + dq2 + dq3) - np.cos(q1 + q2)*(dq1 + dq2) - np.cos(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.cos(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[0, 2] = - np.cos(q1 + q2 + q3)*(dq1 + dq2 + dq3) - np.cos(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.cos(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[0, 3] = - np.cos(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.cos(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[0, 4] = -np.cos(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5)
    dJ[1, 0] = - np.sin(q1 + q2 + q3)*(dq1 + dq2 + dq3) - np.sin(q1 + q2)*(dq1 + dq2) - dq1*np.sin(q1) - np.sin(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.sin(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[1, 1] = - np.sin(q1 + q2 + q3)*(dq1 + dq2 + dq3) - np.sin(q1 + q2)*(dq1 + dq2) - np.sin(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.sin(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[1, 2] = - np.sin(q1 + q2 + q3)*(dq1 + dq2 + dq3) - np.sin(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.sin(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[1, 3] = - np.sin(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5) - np.sin(q1 + q2 + q3 + q4)*(dq1 + dq2 + dq3 + dq4)
    dJ[1, 4] = -np.sin(q1 + q2 + q3 + q4 + q5)*(dq1 + dq2 + dq3 + dq4 + dq5)
    dJ[2, 0] = 0
    dJ[2, 1] = 0
    dJ[2, 2] = 0
    dJ[2, 3] = 0
    dJ[2, 4] = 0

    return dJ

# Derived from EXPLICIT
def getiiwa_dJ( q, dq ):
    dJ = np.zeros( ( 6, 7 ) )
    dJ[ 0, 0 ] = (2*dq[2]*np.cos(q[0])*np.cos(q[2])*np.sin(q[3]))/5 - (21*dq[1]*np.cos(q[1])*np.sin(q[0]))/50 - (2*dq[0]*np.cos(q[0])*np.cos(q[3])*np.sin(q[1]))/5 - (2*dq[1]*np.cos(q[1])*np.cos(q[3])*np.sin(q[0]))/5 - (21*dq[0]*np.cos(q[0])*np.sin(q[1]))/50 + (2*dq[3]*np.cos(q[0])*np.cos(q[3])*np.sin(q[2]))/5 - (2*dq[0]*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/5 + (2*dq[3]*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/5 + (2*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[3]))/5 - (81*dq[0]*np.cos(q[0])*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]))/1000 + (2*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[0]))/5 - (81*dq[1]*np.cos(q[1])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[3])*np.cos(q[5])*np.sin(q[2]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[2])*np.cos(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[2])*np.cos(q[5])*np.sin(q[4]))/1000 - (2*dq[1]*np.cos(q[2])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/5 - (2*dq[2]*np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/5 - (81*dq[0]*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[0]*np.cos(q[2])*np.sin(q[0])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*dq[2]*np.cos(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[3])*np.sin(q[0])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[1]*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[1])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[0]*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[1]*np.cos(q[1])*np.cos(q[4])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[1])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[4])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[1])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]))/1000 + (81*dq[4]*np.cos(q[0])*np.cos(q[3])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[1]*np.sin(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[4]*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0]))/1000 + (81*dq[1]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[4])*np.sin(q[5]))/1000
    dJ[ 0, 1 ] = (dq[3]*np.cos(q[0])*(400*np.cos(q[2])*np.cos(q[3])*np.sin(q[1]) - 400*np.cos(q[1])*np.sin(q[3]) - 81*np.cos(q[1])*np.cos(q[5])*np.sin(q[3]) + 81*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]) + 81*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]) + 81*np.cos(q[2])*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5])))/1000 - (dq[1]*np.cos(q[0])*(420*np.sin(q[1]) + 400*np.cos(q[3])*np.sin(q[1]) - 400*np.cos(q[1])*np.cos(q[2])*np.sin(q[3]) + 81*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]) - 81*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]) - 81*np.cos(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]) + 81*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]) + 81*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5])))/1000 - (dq[0]*np.sin(q[0])*(420*np.cos(q[1]) + 400*np.cos(q[1])*np.cos(q[3]) + 81*np.cos(q[1])*np.cos(q[3])*np.cos(q[5]) + 400*np.cos(q[2])*np.sin(q[1])*np.sin(q[3]) + 81*np.cos(q[2])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]) + 81*np.cos(q[1])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]) + 81*np.sin(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]) - 81*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5])))/1000 - (dq[5]*np.cos(q[0])*(81*np.cos(q[1])*np.cos(q[3])*np.sin(q[5]) - 81*np.cos(q[1])*np.cos(q[4])*np.cos(q[5])*np.sin(q[3]) + 81*np.cos(q[2])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]) - 81*np.cos(q[5])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4]) + 81*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])))/1000 + (81*dq[4]*np.cos(q[0])*np.sin(q[5])*(np.cos(q[4])*np.sin(q[1])*np.sin(q[2]) - np.cos(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[2])*np.cos(q[3])*np.sin(q[1])*np.sin(q[4])))/1000 - (dq[2]*np.cos(q[0])*np.sin(q[1])*(400*np.sin(q[2])*np.sin(q[3]) + 81*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]) - 81*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]) - 81*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5])))/1000
    dJ[ 0, 2 ] = (2*dq[0]*np.cos(q[0])*np.cos(q[2])*np.sin(q[3]))/5 + (2*dq[3]*np.cos(q[2])*np.cos(q[3])*np.sin(q[0]))/5 - (2*dq[2]*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/5 + (2*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[3]))/5 + (2*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.sin(q[2]))/5 + (81*dq[0]*np.cos(q[0])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]))/1000 + (81*dq[3]*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0]))/1000 - (2*dq[0]*np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/5 - (2*dq[1]*np.cos(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[3]))/5 + (81*dq[0]*np.cos(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[2]*np.cos(q[2])*np.sin(q[0])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[2])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[0]*np.cos(q[1])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[0]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[1]*np.cos(q[0])*np.cos(q[5])*np.sin(q[1])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[2])*np.sin(q[1])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[2])*np.cos(q[4])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[5])*np.sin(q[2]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[4]))/1000 - (81*dq[5]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2]))/1000 + (81*dq[0]*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000
    dJ[ 0, 3 ] = (2*dq[0]*np.cos(q[0])*np.cos(q[3])*np.sin(q[2]))/5 - (2*dq[1]*np.cos(q[0])*np.cos(q[1])*np.sin(q[3]))/5 + (2*dq[2]*np.cos(q[2])*np.cos(q[3])*np.sin(q[0]))/5 - (2*dq[3]*np.cos(q[0])*np.cos(q[3])*np.sin(q[1]))/5 + (2*dq[0]*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/5 - (2*dq[3]*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/5 + (2*dq[0]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[0]))/5 + (2*dq[1]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.sin(q[1]))/5 + (2*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.sin(q[2]))/5 + (2*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[3]))/5 + (81*dq[0]*np.cos(q[0])*np.cos(q[3])*np.cos(q[5])*np.sin(q[2]))/1000 - (81*dq[1]*np.cos(q[0])*np.cos(q[1])*np.cos(q[5])*np.sin(q[3]))/1000 + (81*dq[2]*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]))/1000 + (81*dq[0]*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[3]*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[5]*np.cos(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[3])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[4])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[2])*np.cos(q[4])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[3])*np.sin(q[1])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[4]*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[5])*np.sin(q[2]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.cos(q[5])*np.sin(q[3]))/1000 + (81*dq[0]*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[2])*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000
    dJ[ 0, 4 ] = (81*dq[0]*np.sin(q[5])*(np.cos(q[1])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[2])*np.cos(q[4]) + np.cos(q[0])*np.cos(q[3])*np.sin(q[2])*np.sin(q[4]) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[4])))/1000 + (81*dq[2]*np.sin(q[5])*(np.cos(q[4])*np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[4]) + np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[4]) + np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.sin(q[2])*np.sin(q[4])))/1000 + (81*dq[4]*np.sin(q[5])*(np.cos(q[2])*np.sin(q[0])*np.sin(q[4]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[4]) - np.cos(q[0])*np.cos(q[4])*np.sin(q[1])*np.sin(q[3]) + np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])))/1000 - (81*dq[5]*np.cos(q[5])*(np.cos(q[2])*np.cos(q[4])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.sin(q[2]) + np.cos(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4]) - np.cos(q[3])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]) + np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[4])))/1000 - (81*dq[3]*np.sin(q[4])*np.sin(q[5])*(np.sin(q[0])*np.sin(q[2])*np.sin(q[3]) + np.cos(q[0])*np.cos(q[3])*np.sin(q[1]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[3])))/1000 + (81*dq[1]*np.cos(q[0])*np.sin(q[5])*(np.cos(q[4])*np.sin(q[1])*np.sin(q[2]) - np.cos(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[2])*np.cos(q[3])*np.sin(q[1])*np.sin(q[4])))/1000
    dJ[ 0, 5 ] = (81*dq[0]*np.cos(q[3])*np.sin(q[0])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[2])*np.cos(q[5])*np.sin(q[4]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]))/1000 - (81*dq[4]*np.cos(q[2])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0]))/1000 - (81*dq[1]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[2])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[3]*np.cos(q[3])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[5]*np.cos(q[2])*np.sin(q[0])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[1])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[1]*np.cos(q[0])*np.cos(q[2])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[5])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.cos(q[5])*np.sin(q[3]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[4]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0]))/1000 - (81*dq[1]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.cos(q[5])*np.sin(q[3]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[4]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]))/1000
    dJ[ 0, 6 ] = 0
    dJ[ 1, 0 ] = (21*dq[1]*np.cos(q[0])*np.cos(q[1]))/50 - (21*dq[0]*np.sin(q[0])*np.sin(q[1]))/50 + (2*dq[1]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3]))/5 - (2*dq[0]*np.cos(q[3])*np.sin(q[0])*np.sin(q[1]))/5 + (2*dq[0]*np.cos(q[0])*np.sin(q[2])*np.sin(q[3]))/5 + (2*dq[2]*np.cos(q[2])*np.sin(q[0])*np.sin(q[3]))/5 - (2*dq[3]*np.cos(q[0])*np.sin(q[1])*np.sin(q[3]))/5 + (2*dq[3]*np.cos(q[3])*np.sin(q[0])*np.sin(q[2]))/5 - (2*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3]))/5 + (81*dq[1]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[5]))/1000 + (2*dq[0]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[3]))/5 + (2*dq[1]*np.cos(q[0])*np.cos(q[2])*np.sin(q[1])*np.sin(q[3]))/5 + (2*dq[2]*np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[3]))/5 - (81*dq[0]*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*dq[3]*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[3])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[2])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[4]))/1000 + (81*dq[2]*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[2])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[5])*np.sin(q[2])*np.sin(q[4]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[5]*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 + (81*dq[0]*np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[3])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000 - (81*dq[0]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 - (81*dq[1]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[4])*np.sin(q[5]))/1000
    dJ[ 1, 1 ] = (dq[3]*np.sin(q[0])*(400*np.cos(q[2])*np.cos(q[3])*np.sin(q[1]) - 400*np.cos(q[1])*np.sin(q[3]) - 81*np.cos(q[1])*np.cos(q[5])*np.sin(q[3]) + 81*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]) + 81*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5]) + 81*np.cos(q[2])*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5])))/1000 - (dq[5]*np.sin(q[0])*(81*np.cos(q[1])*np.cos(q[3])*np.sin(q[5]) - 81*np.cos(q[1])*np.cos(q[4])*np.cos(q[5])*np.sin(q[3]) + 81*np.cos(q[2])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]) - 81*np.cos(q[5])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4]) + 81*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])))/1000 + (dq[0]*np.cos(q[0])*(420*np.cos(q[1]) + 400*np.cos(q[1])*np.cos(q[3]) + 81*np.cos(q[1])*np.cos(q[3])*np.cos(q[5]) + 400*np.cos(q[2])*np.sin(q[1])*np.sin(q[3]) + 81*np.cos(q[2])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]) + 81*np.cos(q[1])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]) + 81*np.sin(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]) - 81*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5])))/1000 - (dq[1]*np.sin(q[0])*(420*np.sin(q[1]) + 400*np.cos(q[3])*np.sin(q[1]) - 400*np.cos(q[1])*np.cos(q[2])*np.sin(q[3]) + 81*np.cos(q[3])*np.cos(q[5])*np.sin(q[1]) - 81*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]) - 81*np.cos(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]) + 81*np.cos(q[4])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]) + 81*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5])))/1000 + (81*dq[4]*np.sin(q[0])*np.sin(q[5])*(np.cos(q[4])*np.sin(q[1])*np.sin(q[2]) - np.cos(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[2])*np.cos(q[3])*np.sin(q[1])*np.sin(q[4])))/1000 - (dq[2]*np.sin(q[0])*np.sin(q[1])*(400*np.sin(q[2])*np.sin(q[3]) + 81*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]) - 81*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]) - 81*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5])))/1000
    dJ[ 1, 2 ] = (2*dq[0]*np.cos(q[2])*np.sin(q[0])*np.sin(q[3]))/5 - (2*dq[3]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3]))/5 + (2*dq[2]*np.cos(q[0])*np.sin(q[2])*np.sin(q[3]))/5 - (81*dq[3]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5]))/1000 + (2*dq[0]*np.cos(q[0])*np.cos(q[1])*np.sin(q[2])*np.sin(q[3]))/5 + (2*dq[2]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[3]))/5 + (2*dq[3]*np.cos(q[1])*np.cos(q[3])*np.sin(q[0])*np.sin(q[2]))/5 + (81*dq[0]*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[5])*np.sin(q[2])*np.sin(q[4]))/1000 - (2*dq[1]*np.sin(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[3]))/5 + (81*dq[0]*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[2])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[4]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[1]*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[1]*np.cos(q[2])*np.sin(q[0])*np.sin(q[1])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 + (81*dq[1]*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[1])*np.cos(q[3])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000
    dJ[ 1, 3 ] = (2*dq[0]*np.cos(q[3])*np.sin(q[0])*np.sin(q[2]))/5 - (2*dq[0]*np.cos(q[0])*np.sin(q[1])*np.sin(q[3]))/5 - (2*dq[2]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3]))/5 - (2*dq[1]*np.cos(q[1])*np.sin(q[0])*np.sin(q[3]))/5 - (2*dq[3]*np.cos(q[3])*np.sin(q[0])*np.sin(q[1]))/5 + (2*dq[3]*np.cos(q[0])*np.sin(q[2])*np.sin(q[3]))/5 - (2*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3]))/5 - (81*dq[2]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5]))/1000 + (2*dq[1]*np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[1]))/5 + (2*dq[2]*np.cos(q[1])*np.cos(q[3])*np.sin(q[0])*np.sin(q[2]))/5 - (81*dq[0]*np.cos(q[0])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 + (2*dq[3]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[3]))/5 + (81*dq[0]*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 - (81*dq[1]*np.cos(q[1])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 - (81*dq[3]*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[3])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[5]*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 + (81*dq[1]*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[2])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 + (81*dq[0]*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[3])*np.sin(q[0])*np.sin(q[1])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 + (81*dq[1]*np.cos(q[2])*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000
    dJ[ 1, 4 ] = (81*dq[3]*np.sin(q[4])*np.sin(q[5])*(np.cos(q[0])*np.sin(q[2])*np.sin(q[3]) - np.cos(q[3])*np.sin(q[0])*np.sin(q[1]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])*np.sin(q[3])))/1000 - (81*dq[4]*np.sin(q[5])*(np.cos(q[0])*np.cos(q[2])*np.sin(q[4]) + np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]) + np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3]) + np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])))/1000 - (81*dq[5]*np.cos(q[5])*(np.cos(q[1])*np.cos(q[4])*np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[2])*np.cos(q[4]) + np.cos(q[0])*np.cos(q[3])*np.sin(q[2])*np.sin(q[4]) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[4])))/1000 - (81*dq[2]*np.sin(q[5])*(np.cos(q[0])*np.cos(q[4])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.sin(q[4]) - np.cos(q[1])*np.cos(q[3])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])))/1000 - (81*dq[0]*np.sin(q[5])*(np.cos(q[2])*np.cos(q[4])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.cos(q[4])*np.sin(q[2]) + np.cos(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4]) - np.cos(q[3])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4]) + np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[4])))/1000 + (81*dq[1]*np.sin(q[0])*np.sin(q[5])*(np.cos(q[4])*np.sin(q[1])*np.sin(q[2]) - np.cos(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[2])*np.cos(q[3])*np.sin(q[1])*np.sin(q[4])))/1000
    dJ[ 1, 5 ] = (81*dq[4]*np.cos(q[0])*np.cos(q[2])*np.cos(q[4])*np.cos(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[3])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[1]*np.cos(q[1])*np.cos(q[3])*np.sin(q[0])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[4]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[2]*np.cos(q[0])*np.cos(q[5])*np.sin(q[2])*np.sin(q[4]))/1000 + (81*dq[3]*np.cos(q[0])*np.cos(q[3])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1]))/1000 + (81*dq[5]*np.cos(q[0])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[0]*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[3]*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[5])*np.sin(q[2])*np.sin(q[4]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[0]*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 + (81*dq[1]*np.cos(q[1])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 - (81*dq[2]*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[4]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1]))/1000 - (81*dq[4]*np.cos(q[1])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 + (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 - (81*dq[3]*np.cos(q[0])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[4]*np.cos(q[0])*np.cos(q[3])*np.cos(q[5])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[5]*np.cos(q[0])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[1]*np.cos(q[2])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[2]*np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[5])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4]))/1000 + (81*dq[5]*np.cos(q[1])*np.sin(q[0])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000 + (81*dq[0]*np.cos(q[0])*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000 - (81*dq[1]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[1]))/1000 - (81*dq[2]*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[2]))/1000 - (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.cos(q[5])*np.sin(q[0])*np.sin(q[3]))/1000 - (81*dq[4]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[0])*np.sin(q[4]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[0])*np.sin(q[5]))/1000
    dJ[ 1, 6 ] = 0
    dJ[ 2, 0 ] = 0
    dJ[ 2, 1 ] = (2*dq[3]*np.sin(q[1])*np.sin(q[3]))/5 - (2*dq[1]*np.cos(q[1])*np.cos(q[3]))/5 - (21*dq[1]*np.cos(q[1]))/50 + (2*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3]))/5 - (81*dq[1]*np.cos(q[1])*np.cos(q[3])*np.cos(q[5]))/1000 - (2*dq[1]*np.cos(q[2])*np.sin(q[1])*np.sin(q[3]))/5 - (2*dq[2]*np.cos(q[1])*np.sin(q[2])*np.sin(q[3]))/5 + (81*dq[3]*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*dq[5]*np.cos(q[3])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5]))/1000 - (81*dq[1]*np.cos(q[2])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[2]*np.cos(q[1])*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]))/1000 - (81*dq[1]*np.cos(q[1])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[1])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[1])*np.cos(q[5])*np.sin(q[2])*np.sin(q[4]))/1000 - (81*dq[5]*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[1]*np.sin(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[4]*np.sin(q[1])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[2]*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[4]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000
    dJ[ 2, 2 ] = (dq[5]*np.sin(q[1])*(81*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]) + 81*np.cos(q[2])*np.cos(q[5])*np.sin(q[4]) + 81*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[2])))/1000 - (dq[2]*np.sin(q[1])*(400*np.cos(q[2])*np.sin(q[3]) + 81*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]) + 81*np.cos(q[2])*np.cos(q[5])*np.sin(q[3]) - 81*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[5])))/1000 - (dq[1]*np.cos(q[1])*(400*np.sin(q[2])*np.sin(q[3]) + 81*np.cos(q[5])*np.sin(q[2])*np.sin(q[3]) - 81*np.cos(q[2])*np.sin(q[4])*np.sin(q[5]) - 81*np.cos(q[3])*np.cos(q[4])*np.sin(q[2])*np.sin(q[5])))/1000 - (dq[3]*np.sin(q[1])*np.sin(q[2])*(400*np.cos(q[3]) + 81*np.cos(q[3])*np.cos(q[5]) + 81*np.cos(q[4])*np.sin(q[3])*np.sin(q[5])))/1000 + (81*dq[4]*np.sin(q[1])*np.sin(q[5])*(np.cos(q[2])*np.cos(q[4]) - np.cos(q[3])*np.sin(q[2])*np.sin(q[4])))/1000
    dJ[ 2, 3 ] = (2*dq[1]*np.sin(q[1])*np.sin(q[3]))/5 - (2*dq[3]*np.cos(q[1])*np.cos(q[3]))/5 + (2*dq[1]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3]))/5 - (81*dq[3]*np.cos(q[1])*np.cos(q[3])*np.cos(q[5]))/1000 - (2*dq[2]*np.cos(q[3])*np.sin(q[1])*np.sin(q[2]))/5 - (2*dq[3]*np.cos(q[2])*np.sin(q[1])*np.sin(q[3]))/5 + (81*dq[1]*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*dq[5]*np.cos(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[5]))/1000 + (81*dq[5]*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000 - (81*dq[2]*np.cos(q[3])*np.cos(q[5])*np.sin(q[1])*np.sin(q[2]))/1000 - (81*dq[1]*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[3]*np.cos(q[2])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[3]*np.cos(q[1])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[5]*np.cos(q[2])*np.cos(q[3])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[1])*np.cos(q[3])*np.sin(q[4])*np.sin(q[5]))/1000 + (81*dq[1]*np.cos(q[1])*np.cos(q[2])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*dq[3]*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*dq[5]*np.cos(q[2])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 - (81*dq[2]*np.cos(q[4])*np.sin(q[1])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*dq[4]*np.cos(q[2])*np.sin(q[1])*np.sin(q[3])*np.sin(q[4])*np.sin(q[5]))/1000
    dJ[ 2, 4 ] = (81*dq[1]*np.sin(q[5])*(np.sin(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[1])*np.cos(q[4])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.sin(q[4])))/1000 - (81*dq[4]*np.sin(q[5])*(np.sin(q[1])*np.sin(q[2])*np.sin(q[4]) + np.cos(q[1])*np.cos(q[4])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])))/1000 + (81*dq[5]*np.cos(q[5])*(np.cos(q[4])*np.sin(q[1])*np.sin(q[2]) - np.cos(q[1])*np.sin(q[3])*np.sin(q[4]) + np.cos(q[2])*np.cos(q[3])*np.sin(q[1])*np.sin(q[4])))/1000 - (81*dq[3]*np.sin(q[4])*np.sin(q[5])*(np.cos(q[1])*np.cos(q[3]) + np.cos(q[2])*np.sin(q[1])*np.sin(q[3])))/1000 + (81*dq[2]*np.sin(q[1])*np.sin(q[5])*(np.cos(q[2])*np.cos(q[4]) - np.cos(q[3])*np.sin(q[2])*np.sin(q[4])))/1000
    dJ[ 2, 5 ] = dq[3]*((81*np.cos(q[1])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*np.cos(q[1])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000 - (81*np.cos(q[2])*np.cos(q[3])*np.sin(q[1])*np.sin(q[5]))/1000 + (81*np.cos(q[2])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000) - dq[5]*((81*np.cos(q[1])*np.cos(q[3])*np.cos(q[5]))/1000 + (81*np.cos(q[2])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*np.cos(q[1])*np.cos(q[4])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*np.sin(q[1])*np.sin(q[2])*np.sin(q[4])*np.sin(q[5]))/1000 - (81*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[5]))/1000) - dq[1]*((81*np.cos(q[1])*np.cos(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 - (81*np.cos(q[3])*np.sin(q[1])*np.sin(q[5]))/1000 - (81*np.cos(q[1])*np.cos(q[5])*np.sin(q[2])*np.sin(q[4]))/1000 + (81*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[3]))/1000 + (81*np.cos(q[1])*np.cos(q[2])*np.cos(q[3])*np.cos(q[4])*np.cos(q[5]))/1000) + dq[4]*((81*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[2]))/1000 - (81*np.cos(q[1])*np.cos(q[5])*np.sin(q[3])*np.sin(q[4]))/1000 + (81*np.cos(q[2])*np.cos(q[3])*np.cos(q[5])*np.sin(q[1])*np.sin(q[4]))/1000) + dq[2]*((81*np.cos(q[2])*np.cos(q[5])*np.sin(q[1])*np.sin(q[4]))/1000 + (81*np.sin(q[1])*np.sin(q[2])*np.sin(q[3])*np.sin(q[5]))/1000 + (81*np.cos(q[3])*np.cos(q[4])*np.cos(q[5])*np.sin(q[1])*np.sin(q[2]))/1000)
    dJ[ 2, 6 ] = 0
    dJ[ 3, 0 ] = 0
    dJ[ 3, 1 ] = -dq[0]*np.cos(q[0])
    dJ[ 3, 2 ] = dq[1]*np.cos(q[0])*np.cos(q[1]) - dq[0]*np.sin(q[0])*np.sin(q[1])
    dJ[ 3, 3 ] = dq[0]*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2])) - dq[2]*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - dq[1]*np.cos(q[0])*np.sin(q[1])*np.sin(q[2])
    dJ[ 3, 4 ] = dq[3]*(np.cos(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[0])*np.sin(q[1])*np.sin(q[3])) + dq[0]*(np.sin(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) - np.cos(q[3])*np.sin(q[0])*np.sin(q[1])) + dq[1]*(np.cos(q[0])*np.cos(q[1])*np.cos(q[3]) + np.cos(q[0])*np.cos(q[2])*np.sin(q[1])*np.sin(q[3])) + dq[2]*np.sin(q[3])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2]))
    dJ[ 3, 5 ] = dq[0]*(np.sin(q[4])*(np.cos(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) - np.cos(q[4])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2]))) + dq[2]*(np.cos(q[4])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) + np.cos(q[3])*np.sin(q[4])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2]))) - dq[1]*(np.sin(q[4])*(np.cos(q[0])*np.cos(q[1])*np.sin(q[3]) - np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.sin(q[1])) - np.cos(q[0])*np.cos(q[4])*np.sin(q[1])*np.sin(q[2])) + dq[4]*(np.cos(q[4])*(np.cos(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[0])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[4])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2]))) - dq[3]*np.sin(q[4])*(np.sin(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) + np.cos(q[0])*np.cos(q[3])*np.sin(q[1]))
    dJ[ 3, 6 ] = dq[1]*(np.cos(q[5])*(np.cos(q[0])*np.cos(q[1])*np.cos(q[3]) + np.cos(q[0])*np.cos(q[2])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[5])*(np.cos(q[4])*(np.cos(q[0])*np.cos(q[1])*np.sin(q[3]) - np.cos(q[0])*np.cos(q[2])*np.cos(q[3])*np.sin(q[1])) + np.cos(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4]))) + dq[2]*(np.sin(q[5])*(np.sin(q[4])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[3])*np.cos(q[4])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2]))) + np.cos(q[5])*np.sin(q[3])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2]))) + dq[3]*(np.cos(q[5])*(np.cos(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[0])*np.sin(q[1])*np.sin(q[3])) + np.cos(q[4])*np.sin(q[5])*(np.sin(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) + np.cos(q[0])*np.cos(q[3])*np.sin(q[1]))) - dq[5]*(np.sin(q[5])*(np.sin(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) + np.cos(q[0])*np.cos(q[3])*np.sin(q[1])) + np.cos(q[5])*(np.cos(q[4])*(np.cos(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[0])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[4])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2])))) + dq[0]*(np.cos(q[5])*(np.sin(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) - np.cos(q[3])*np.sin(q[0])*np.sin(q[1])) - np.sin(q[5])*(np.cos(q[4])*(np.cos(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[4])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2])))) + dq[4]*np.sin(q[5])*(np.sin(q[4])*(np.cos(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[0])*np.sin(q[1])*np.sin(q[3])) - np.cos(q[4])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2])))
    dJ[ 4, 0 ] = 0
    dJ[ 4, 1 ] = -dq[0]*np.sin(q[0])
    dJ[ 4, 2 ] = dq[0]*np.cos(q[0])*np.sin(q[1]) + dq[1]*np.cos(q[1])*np.sin(q[0])
    dJ[ 4, 3 ] = dq[0]*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2])) + dq[2]*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) - dq[1]*np.sin(q[0])*np.sin(q[1])*np.sin(q[2])
    dJ[ 4, 4 ] = dq[0]*(np.sin(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) + np.cos(q[0])*np.cos(q[3])*np.sin(q[1])) - dq[3]*(np.cos(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) + dq[1]*(np.cos(q[1])*np.cos(q[3])*np.sin(q[0]) + np.cos(q[2])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) - dq[2]*np.sin(q[3])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2]))
    dJ[ 4, 5 ] = dq[0]*(np.sin(q[4])*(np.cos(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[0])*np.sin(q[1])*np.sin(q[3])) - np.cos(q[4])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2]))) - dq[2]*(np.cos(q[4])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.cos(q[3])*np.sin(q[4])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2]))) - dq[1]*(np.sin(q[4])*(np.cos(q[1])*np.sin(q[0])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[1])) - np.cos(q[4])*np.sin(q[0])*np.sin(q[1])*np.sin(q[2])) - dq[4]*(np.cos(q[4])*(np.cos(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[4])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2]))) + dq[3]*np.sin(q[4])*(np.sin(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) - np.cos(q[3])*np.sin(q[0])*np.sin(q[1]))
    dJ[ 4, 6 ] = dq[1]*(np.cos(q[5])*(np.cos(q[1])*np.cos(q[3])*np.sin(q[0]) + np.cos(q[2])*np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[5])*(np.cos(q[4])*(np.cos(q[1])*np.sin(q[0])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.sin(q[0])*np.sin(q[1])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4]))) - dq[3]*(np.cos(q[5])*(np.cos(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) + np.cos(q[4])*np.sin(q[5])*(np.sin(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) - np.cos(q[3])*np.sin(q[0])*np.sin(q[1]))) - dq[2]*(np.sin(q[5])*(np.sin(q[4])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) - np.cos(q[3])*np.cos(q[4])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2]))) + np.cos(q[5])*np.sin(q[3])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2]))) + dq[0]*(np.cos(q[5])*(np.sin(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) + np.cos(q[0])*np.cos(q[3])*np.sin(q[1])) - np.sin(q[5])*(np.cos(q[4])*(np.cos(q[3])*(np.sin(q[0])*np.sin(q[2]) - np.cos(q[0])*np.cos(q[1])*np.cos(q[2])) - np.cos(q[0])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[4])*(np.cos(q[2])*np.sin(q[0]) + np.cos(q[0])*np.cos(q[1])*np.sin(q[2])))) + dq[5]*(np.sin(q[5])*(np.sin(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) - np.cos(q[3])*np.sin(q[0])*np.sin(q[1])) + np.cos(q[5])*(np.cos(q[4])*(np.cos(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) + np.sin(q[4])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2])))) - dq[4]*np.sin(q[5])*(np.sin(q[4])*(np.cos(q[3])*(np.cos(q[0])*np.sin(q[2]) + np.cos(q[1])*np.cos(q[2])*np.sin(q[0])) + np.sin(q[0])*np.sin(q[1])*np.sin(q[3])) - np.cos(q[4])*(np.cos(q[0])*np.cos(q[2]) - np.cos(q[1])*np.sin(q[0])*np.sin(q[2])))
    dJ[ 5, 0 ] = 0
    dJ[ 5, 1 ] = 0
    dJ[ 5, 2 ] = -dq[1]*np.sin(q[1])
    dJ[ 5, 3 ] = - dq[1]*np.cos(q[1])*np.sin(q[2]) - dq[2]*np.cos(q[2])*np.sin(q[1])
    dJ[ 5, 4 ] = - dq[1]*(np.cos(q[3])*np.sin(q[1]) - np.cos(q[1])*np.cos(q[2])*np.sin(q[3])) - dq[3]*(np.cos(q[1])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.sin(q[1])) - dq[2]*np.sin(q[1])*np.sin(q[2])*np.sin(q[3])
    dJ[ 5, 5 ] = dq[1]*(np.sin(q[4])*(np.sin(q[1])*np.sin(q[3]) + np.cos(q[1])*np.cos(q[2])*np.cos(q[3])) + np.cos(q[1])*np.cos(q[4])*np.sin(q[2])) - dq[4]*(np.cos(q[4])*(np.cos(q[1])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.sin(q[1])) + np.sin(q[1])*np.sin(q[2])*np.sin(q[4])) + dq[2]*(np.cos(q[2])*np.cos(q[4])*np.sin(q[1]) - np.cos(q[3])*np.sin(q[1])*np.sin(q[2])*np.sin(q[4])) - dq[3]*np.sin(q[4])*(np.cos(q[1])*np.cos(q[3]) + np.cos(q[2])*np.sin(q[1])*np.sin(q[3]))
    dJ[ 5, 6 ] = dq[5]*(np.cos(q[5])*(np.cos(q[4])*(np.cos(q[1])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.sin(q[1])) + np.sin(q[1])*np.sin(q[2])*np.sin(q[4])) - np.sin(q[5])*(np.cos(q[1])*np.cos(q[3]) + np.cos(q[2])*np.sin(q[1])*np.sin(q[3]))) - dq[3]*(np.cos(q[5])*(np.cos(q[1])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.sin(q[1])) - np.cos(q[4])*np.sin(q[5])*(np.cos(q[1])*np.cos(q[3]) + np.cos(q[2])*np.sin(q[1])*np.sin(q[3]))) + dq[2]*(np.sin(q[5])*(np.cos(q[2])*np.sin(q[1])*np.sin(q[4]) + np.cos(q[3])*np.cos(q[4])*np.sin(q[1])*np.sin(q[2])) - np.cos(q[5])*np.sin(q[1])*np.sin(q[2])*np.sin(q[3])) - dq[1]*(np.sin(q[5])*(np.cos(q[4])*(np.sin(q[1])*np.sin(q[3]) + np.cos(q[1])*np.cos(q[2])*np.cos(q[3])) - np.cos(q[1])*np.sin(q[2])*np.sin(q[4])) + np.cos(q[5])*(np.cos(q[3])*np.sin(q[1]) - np.cos(q[1])*np.cos(q[2])*np.sin(q[3]))) - dq[4]*np.sin(q[5])*(np.sin(q[4])*(np.cos(q[1])*np.sin(q[3]) - np.cos(q[2])*np.cos(q[3])*np.sin(q[1])) - np.cos(q[4])*np.sin(q[1])*np.sin(q[2]))

    return dJ